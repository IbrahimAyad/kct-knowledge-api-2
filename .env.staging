# Staging Environment Configuration
# KCT Knowledge API - Phase 4

# Environment
NODE_ENV=staging

# Server Configuration
API_PORT=3000
WS_PORT=8080
HOST=0.0.0.0

# Database Configuration
DATABASE_URL=postgresql://kct_staging_user:${DB_PASSWORD}@staging-db.kct.internal:5432/kct_knowledge_staging
DATABASE_SSL=true
DATABASE_LOGGING=false
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_CONNECTION_TIMEOUT=30000

# Redis Configuration
REDIS_URL=redis://staging-redis.kct.internal:6379
REDIS_PREFIX=kct:staging:
REDIS_TTL=7200
REDIS_CLUSTER_MODE=false

# Authentication
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRES_IN=8h
REFRESH_TOKEN_EXPIRES_IN=7d
JWT_ALGORITHM=HS256

# API Keys & External Services
OPENAI_API_KEY=${OPENAI_API_KEY}
OPENAI_MODEL=gpt-3.5-turbo
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=1000
OPENAI_RATE_LIMIT=60

# AWS Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
S3_BUCKET_NAME=kct-staging-assets
CLOUDFRONT_DOMAIN=staging-cdn.kct.com

# Monitoring & Analytics
ENABLE_ANALYTICS=true
ANALYTICS_SAMPLING_RATE=50
ENABLE_PERFORMANCE_MONITORING=true
ENABLE_ERROR_TRACKING=true
SENTRY_DSN=${SENTRY_DSN}

# Logging
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_FILE=logs/staging.log
ENABLE_REQUEST_LOGGING=true
LOG_ROTATION_MAX_SIZE=10mb
LOG_ROTATION_MAX_FILES=5

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=500
RATE_LIMIT_SKIP_FAILED_REQUESTS=true
ENABLE_DISTRIBUTED_RATE_LIMITING=true

# CORS Configuration
CORS_ORIGIN=https://staging.kct.com,https://staging-admin.kct.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With
CORS_CREDENTIALS=true

# Cache Configuration
CACHE_TTL=3600
CACHE_CHECK_PERIOD=600
ENABLE_CACHE_COMPRESSION=true
CACHE_MEMORY_LIMIT=512mb

# WebSocket Configuration
WS_HEARTBEAT_INTERVAL=30000
WS_CONNECTION_TIMEOUT=60000
WS_MAX_CONNECTIONS=5000

# Framework Configuration
DEFAULT_FRAMEWORK=atelier
FRAMEWORK_CONFIDENCE_THRESHOLD=0.75
ENABLE_FRAMEWORK_SWITCHING=true
FRAMEWORK_ANALYTICS_ENABLED=true

# Chat Configuration
MAX_CONVERSATION_LENGTH=50
CONVERSATION_TIMEOUT_MINUTES=60
ENABLE_CONVERSATION_PERSISTENCE=true
ENABLE_TYPING_INDICATORS=true
CONVERSATION_ARCHIVE_DAYS=30

# Staging Features
ENABLE_API_DOCS=true
ENABLE_DEBUG_ROUTES=false
ENABLE_TEST_DATA=false
ENABLE_MOCK_SERVICES=false

# Notification Configuration
NOTIFICATION_EMAIL=${NOTIFICATION_EMAIL}
SLACK_WEBHOOK_URL=${SLACK_WEBHOOK_URL}
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_SLACK_NOTIFICATIONS=true

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=5000
ENABLE_DETAILED_HEALTH=true
HEALTH_CHECK_ENDPOINTS=database,redis,external-apis

# Performance Configuration
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=65000
BODY_PARSER_LIMIT=5mb
CLUSTER_WORKERS=2

# Security Configuration
HELMET_CSP_ENABLED=true
ENABLE_SECURITY_HEADERS=true
SESSION_SECURE=true
COOKIE_SECURE=true
TRUST_PROXY=1

# SSL Configuration
SSL_CERT_PATH=/etc/ssl/certs/staging.kct.com.pem
SSL_KEY_PATH=/etc/ssl/private/staging.kct.com.key
FORCE_HTTPS=true

# Backup Configuration
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=kct-staging-backups

# Load Testing
ENABLE_LOAD_TEST_ENDPOINTS=true
LOAD_TEST_MAX_CONCURRENT=100

# Feature Flags
ENABLE_NEW_CHAT_FEATURES=true
ENABLE_ADVANCED_ANALYTICS=true
ENABLE_A_B_TESTING=true

# CDN Configuration
STATIC_ASSETS_CDN=https://staging-cdn.kct.com
ENABLE_CDN_CACHE_HEADERS=true

# Deployment Configuration
DEPLOYMENT_ENVIRONMENT=staging
DEPLOYMENT_REGION=us-east-1
LOAD_BALANCER_HEALTH_CHECK=/api/health